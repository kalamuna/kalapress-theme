jQuery(document).ready(function($) {
    searchActive = false;
    $(document).keyup(function(e) {
        if (e.keyCode === 27) {
            $("header").removeClass("search-active");
        }
        if (e.keyCode === 13 && searchActive === true) {
            $("header .search-button").click();
        }
    });
    $("html").click(function(e) {
        if (searchActive) {
            if (!$(e.target).hasClass("search-widget") && !$(".search-widget").has(e.target).length) {
                $("header").removeClass("search-active");
            }
        }
    });
    $("header .search-button").click(function() {
        if ($("header").hasClass("search-active")) {
            if ($.trim($("header .search-input").val()).length !== 0) {
                window.location.href = "/?s=" + $("header .search-input").val();
            } else {
                $("header .search-widget").addClass("shake");
                setTimeout(function() {
                    $("header .search-widget").removeClass("shake");
                }, 830);
            }
        } else {
            $("header").addClass("search-active");
            $("header .search-input").focus();
            searchActive = true;
        }
    });
});